
@{
    ViewBag.Title = "Context Is Needed";
    Layout = "~/Views/Application/_ApplicationLayout.cshtml";
}

@section MenuItems{
<li role="presentation" onclick="refresh()"><a role="menuitem" tabindex="-1">Refresh</a></li>
<li role="presentation"><a role="menuitem" tabindex="-1" href="#">Submit A Link</a></li>
<li role="presentation" onclick="about()"><a role="menuitem" tabindex="-1">About ContextIsNeeded</a></li>
}
<style>
    html {
        background: url(@Url.Content(ViewBag.Image)) no-repeat center center fixed; 
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        -ms-background-size: cover;
        background-size: cover;
    }

    body {
        padding: 0px;
    }

    .CaptionBlock{
       position:fixed;
       top:@ViewBag.QuestionTop%;
       left:@ViewBag.QuestionLeft%;
       width:40%;
        padding: 15px;
    }

    .bubble 
{
       position:fixed;
       top:@ViewBag.QuestionTop%;
       left:@ViewBag.QuestionLeft%;
       width:35%;
        padding: 15px;
background: #FFFFFF;
-webkit-border-radius: 10px;
-moz-border-radius: 10px;
border-radius: 10px;
border: #5200FF solid 2px;
}

.bubble:after 
{
content: '';
position: absolute;
border-style: solid;
border-width: 20px 15px 20px 0;
border-color: transparent #FFFFFF;
display: block;
width: 0;
z-index: 1;
margin-top: -20px;
left: -15px;
top: 50%;
}

.bubble:before 
{
content: '';
position: absolute;
border-style: solid;
border-width: 21px 16px 21px 0;
border-color: transparent #5200FF;
display: block;
width: 0;
z-index: 0;
margin-top: -21px;
left: -18px;
top: 50%;
}
</style>

<div class="bubble panel panel-default h4"><a class="question" href="@ViewBag.Question.Url">@ViewBag.Question.Caption</a></div>
<div class ="about panel panel-primary col-lg-3 col-lg-offset-3 hidden">
    <div class="panel-heading" onclick="about()">About Context Is Needed<span class="glyphicon glyphicon-remove pull-right"></span></div>
    <div class="panel-body">
        <p>Context Is Needed is a web application developed by Vernon Burt to present Stack Exchange network questions that are terribly out of context.</p>
        <p>If you have any questions/ comments/ suggestions feel free to contact me at: <a href="mailto:houseofburtsoftware@yahoo.com">HouseOfBurtSoftware</a></p>
    </div>
</div>
<script>
    function refresh() {
        $.ajax({
            url: "../Application/ContextNeededEndpoint"
        }).then(function(data) {
            $('html').css('background', 'url(' + data.url + ') no-repeat center center fixed');
            $('.bubble').css('top', data.top + '%').css('left', data.left + '%');
            $('.question').attr("href", data.link).text(data.caption);
        });
    }

    function about() {
        if ($('.about').hasClass('hidden'))
        {
          $('.about').removeClass('hidden');
        } else {
          $('.about').addClass('hidden');
        }
    }
</script>